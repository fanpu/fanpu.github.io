<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Breaking CMU's Bomblab with Angr for Fun and Profit - Part 6 | Fan Pu Zeng </title> <meta name="author" content="Fan Pu Zeng"> <meta name="description" content="We tackle Part 6 of this series on cracking CMU's Bomblab with Angr! "> <meta name="keywords" content="fanpu, fan pu, fanpu zeng, fan pu zeng, zengfanpu, fanpuzeng, fzeng, CMU, cmu, carnegie mellon, cmu courses, school of computer science, scs, machine learning, computer science, ml, theory, courses, course reviews, CS, Jane Street"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="/assets/img/favicon_new.ico?426605099301e95aedae716cc398b951"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://fanpu.github.io/blog/2020/breaking-cmu-bomblab-with-angr-for-fun-and-profit-part-6/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Fan Pu</span> Zeng </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/courses/">CMU Course Reviews </a> </li> <li class="nav-item "> <a class="nav-link" href="/cmu-online/">CMU Online </a> </li> <li class="nav-item "> <a class="nav-link" href="/summaries/">ML Paper Summaries </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Breaking CMU's Bomblab with Angr for Fun and Profit - Part 6</h1> <p class="post-meta"> Created in August 02, 2020 by fanpu </p> <p class="post-tags"> <a href="/blog/2020"> <i class="fa-solid fa-calendar fa-sm"></i> 2020 </a>   ·   <a href="/blog/tag/rev"> <i class="fa-solid fa-hashtag fa-sm"></i> rev</a>   <a href="/blog/tag/ctf"> <i class="fa-solid fa-hashtag fa-sm"></i> ctf</a>   <a href="/blog/tag/code"> <i class="fa-solid fa-hashtag fa-sm"></i> code</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Hello from Part 6 of this series on cracking CMU’s Bomblab with Angr. If you are new here, I would recommend starting with part 1 <a href="/blog/2020/breaking-cmu-bomblab-with-angr-for-fun-and-profit-part-1/">here</a>.</p> <h3 id="phase-6">Phase 6</h3> <p>Let’s disassemble Phase 6:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
</pre></td> <td class="code"><pre><span class="n">gef</span><span class="err">➤</span>  <span class="n">disas</span> <span class="n">phase_6</span>
<span class="n">Dump</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">code</span> <span class="k">for</span> <span class="n">function</span> <span class="n">phase_6</span><span class="o">:</span>
   <span class="mh">0x00000000004010f4</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;:</span>	<span class="n">push</span>   <span class="n">r14</span>
   <span class="mh">0x00000000004010f6</span> <span class="o">&lt;+</span><span class="mi">2</span><span class="o">&gt;:</span>	<span class="n">push</span>   <span class="n">r13</span>
   <span class="mh">0x00000000004010f8</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;:</span>	<span class="n">push</span>   <span class="n">r12</span>
   <span class="mh">0x00000000004010fa</span> <span class="o">&lt;+</span><span class="mi">6</span><span class="o">&gt;:</span>	<span class="n">push</span>   <span class="n">rbp</span>
   <span class="mh">0x00000000004010fb</span> <span class="o">&lt;+</span><span class="mi">7</span><span class="o">&gt;:</span>	<span class="n">push</span>   <span class="n">rbx</span>
   <span class="mh">0x00000000004010fc</span> <span class="o">&lt;+</span><span class="mi">8</span><span class="o">&gt;:</span>	<span class="n">sub</span>    <span class="n">rsp</span><span class="p">,</span><span class="mh">0x50</span>
   <span class="mh">0x0000000000401100</span> <span class="o">&lt;+</span><span class="mi">12</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">r13</span><span class="p">,</span><span class="n">rsp</span>
   <span class="mh">0x0000000000401103</span> <span class="o">&lt;+</span><span class="mi">15</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rsi</span><span class="p">,</span><span class="n">rsp</span>
   <span class="mh">0x0000000000401106</span> <span class="o">&lt;+</span><span class="mi">18</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x40145c</span> <span class="o">&lt;</span><span class="n">read_six_numbers</span><span class="o">&gt;</span>
   <span class="mh">0x000000000040110b</span> <span class="o">&lt;+</span><span class="mi">23</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">r14</span><span class="p">,</span><span class="n">rsp</span>
   <span class="mh">0x000000000040110e</span> <span class="o">&lt;+</span><span class="mi">26</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">r12d</span><span class="p">,</span><span class="mh">0x0</span>
   <span class="mh">0x0000000000401114</span> <span class="o">&lt;+</span><span class="mi">32</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rbp</span><span class="p">,</span><span class="n">r13</span>
   <span class="mh">0x0000000000401117</span> <span class="o">&lt;+</span><span class="mi">35</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">r13</span><span class="o">+</span><span class="mh">0x0</span><span class="p">]</span>
   <span class="mh">0x000000000040111b</span> <span class="o">&lt;+</span><span class="mi">39</span><span class="o">&gt;:</span>	<span class="n">sub</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x1</span>
   <span class="mh">0x000000000040111e</span> <span class="o">&lt;+</span><span class="mi">42</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x5</span>
   <span class="mh">0x0000000000401121</span> <span class="o">&lt;+</span><span class="mi">45</span><span class="o">&gt;:</span>	<span class="n">jbe</span>    <span class="mh">0x401128</span> <span class="o">&lt;</span><span class="n">phase_6</span><span class="o">+</span><span class="mi">52</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401123</span> <span class="o">&lt;+</span><span class="mi">47</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x40143a</span> <span class="o">&lt;</span><span class="n">explode_bomb</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401128</span> <span class="o">&lt;+</span><span class="mi">52</span><span class="o">&gt;:</span>	<span class="n">add</span>    <span class="n">r12d</span><span class="p">,</span><span class="mh">0x1</span>
   <span class="mh">0x000000000040112c</span> <span class="o">&lt;+</span><span class="mi">56</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">r12d</span><span class="p">,</span><span class="mh">0x6</span>
   <span class="mh">0x0000000000401130</span> <span class="o">&lt;+</span><span class="mi">60</span><span class="o">&gt;:</span>	<span class="n">je</span>     <span class="mh">0x401153</span> <span class="o">&lt;</span><span class="n">phase_6</span><span class="o">+</span><span class="mi">95</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401132</span> <span class="o">&lt;+</span><span class="mi">62</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">ebx</span><span class="p">,</span><span class="n">r12d</span>
   <span class="mh">0x0000000000401135</span> <span class="o">&lt;+</span><span class="mi">65</span><span class="o">&gt;:</span>	<span class="n">movsxd</span> <span class="n">rax</span><span class="p">,</span><span class="n">ebx</span>
   <span class="mh">0x0000000000401138</span> <span class="o">&lt;+</span><span class="mi">68</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rsp</span><span class="o">+</span><span class="n">rax</span><span class="o">*</span><span class="mi">4</span><span class="p">]</span>
   <span class="mh">0x000000000040113b</span> <span class="o">&lt;+</span><span class="mi">71</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">+</span><span class="mh">0x0</span><span class="p">],</span><span class="n">eax</span>
   <span class="mh">0x000000000040113e</span> <span class="o">&lt;+</span><span class="mi">74</span><span class="o">&gt;:</span>	<span class="n">jne</span>    <span class="mh">0x401145</span> <span class="o">&lt;</span><span class="n">phase_6</span><span class="o">+</span><span class="mi">81</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401140</span> <span class="o">&lt;+</span><span class="mi">76</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x40143a</span> <span class="o">&lt;</span><span class="n">explode_bomb</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401145</span> <span class="o">&lt;+</span><span class="mi">81</span><span class="o">&gt;:</span>	<span class="n">add</span>    <span class="n">ebx</span><span class="p">,</span><span class="mh">0x1</span>
   <span class="mh">0x0000000000401148</span> <span class="o">&lt;+</span><span class="mi">84</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">ebx</span><span class="p">,</span><span class="mh">0x5</span>
   <span class="mh">0x000000000040114b</span> <span class="o">&lt;+</span><span class="mi">87</span><span class="o">&gt;:</span>	<span class="n">jle</span>    <span class="mh">0x401135</span> <span class="o">&lt;</span><span class="n">phase_6</span><span class="o">+</span><span class="mi">65</span><span class="o">&gt;</span>
   <span class="mh">0x000000000040114d</span> <span class="o">&lt;+</span><span class="mi">89</span><span class="o">&gt;:</span>	<span class="n">add</span>    <span class="n">r13</span><span class="p">,</span><span class="mh">0x4</span>
   <span class="mh">0x0000000000401151</span> <span class="o">&lt;+</span><span class="mi">93</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x401114</span> <span class="o">&lt;</span><span class="n">phase_6</span><span class="o">+</span><span class="mi">32</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401153</span> <span class="o">&lt;+</span><span class="mi">95</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rsi</span><span class="p">,[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0x18</span><span class="p">]</span>
   <span class="mh">0x0000000000401158</span> <span class="o">&lt;+</span><span class="mi">100</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rax</span><span class="p">,</span><span class="n">r14</span>
   <span class="mh">0x000000000040115b</span> <span class="o">&lt;+</span><span class="mi">103</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">ecx</span><span class="p">,</span><span class="mh">0x7</span>
   <span class="mh">0x0000000000401160</span> <span class="o">&lt;+</span><span class="mi">108</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="n">ecx</span>
   <span class="mh">0x0000000000401162</span> <span class="o">&lt;+</span><span class="mi">110</span><span class="o">&gt;:</span>	<span class="n">sub</span>    <span class="n">edx</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rax</span><span class="p">]</span>
   <span class="mh">0x0000000000401164</span> <span class="o">&lt;+</span><span class="mi">112</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rax</span><span class="p">],</span><span class="n">edx</span>
   <span class="mh">0x0000000000401166</span> <span class="o">&lt;+</span><span class="mi">114</span><span class="o">&gt;:</span>	<span class="n">add</span>    <span class="n">rax</span><span class="p">,</span><span class="mh">0x4</span>
   <span class="mh">0x000000000040116a</span> <span class="o">&lt;+</span><span class="mi">118</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">rax</span><span class="p">,</span><span class="n">rsi</span>
   <span class="mh">0x000000000040116d</span> <span class="o">&lt;+</span><span class="mi">121</span><span class="o">&gt;:</span>	<span class="n">jne</span>    <span class="mh">0x401160</span> <span class="o">&lt;</span><span class="n">phase_6</span><span class="o">+</span><span class="mi">108</span><span class="o">&gt;</span>
   <span class="mh">0x000000000040116f</span> <span class="o">&lt;+</span><span class="mi">123</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">esi</span><span class="p">,</span><span class="mh">0x0</span>
   <span class="mh">0x0000000000401174</span> <span class="o">&lt;+</span><span class="mi">128</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x401197</span> <span class="o">&lt;</span><span class="n">phase_6</span><span class="o">+</span><span class="mi">163</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401176</span> <span class="o">&lt;+</span><span class="mi">130</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rdx</span><span class="p">,</span><span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rdx</span><span class="o">+</span><span class="mh">0x8</span><span class="p">]</span>
   <span class="mh">0x000000000040117a</span> <span class="o">&lt;+</span><span class="mi">134</span><span class="o">&gt;:</span>	<span class="n">add</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x1</span>
   <span class="mh">0x000000000040117d</span> <span class="o">&lt;+</span><span class="mi">137</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="n">ecx</span>
   <span class="mh">0x000000000040117f</span> <span class="o">&lt;+</span><span class="mi">139</span><span class="o">&gt;:</span>	<span class="n">jne</span>    <span class="mh">0x401176</span> <span class="o">&lt;</span><span class="n">phase_6</span><span class="o">+</span><span class="mi">130</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401181</span> <span class="o">&lt;+</span><span class="mi">141</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x401188</span> <span class="o">&lt;</span><span class="n">phase_6</span><span class="o">+</span><span class="mi">148</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401183</span> <span class="o">&lt;+</span><span class="mi">143</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="mh">0x6032d0</span>
   <span class="mh">0x0000000000401188</span> <span class="o">&lt;+</span><span class="mi">148</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rsp</span><span class="o">+</span><span class="n">rsi</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mh">0x20</span><span class="p">],</span><span class="n">rdx</span>
   <span class="mh">0x000000000040118d</span> <span class="o">&lt;+</span><span class="mi">153</span><span class="o">&gt;:</span>	<span class="n">add</span>    <span class="n">rsi</span><span class="p">,</span><span class="mh">0x4</span>
   <span class="mh">0x0000000000401191</span> <span class="o">&lt;+</span><span class="mi">157</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">rsi</span><span class="p">,</span><span class="mh">0x18</span>
   <span class="mh">0x0000000000401195</span> <span class="o">&lt;+</span><span class="mi">161</span><span class="o">&gt;:</span>	<span class="n">je</span>     <span class="mh">0x4011ab</span> <span class="o">&lt;</span><span class="n">phase_6</span><span class="o">+</span><span class="mi">183</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401197</span> <span class="o">&lt;+</span><span class="mi">163</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">ecx</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rsp</span><span class="o">+</span><span class="n">rsi</span><span class="o">*</span><span class="mi">1</span><span class="p">]</span>
   <span class="mh">0x000000000040119a</span> <span class="o">&lt;+</span><span class="mi">166</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">ecx</span><span class="p">,</span><span class="mh">0x1</span>
   <span class="mh">0x000000000040119d</span> <span class="o">&lt;+</span><span class="mi">169</span><span class="o">&gt;:</span>	<span class="n">jle</span>    <span class="mh">0x401183</span> <span class="o">&lt;</span><span class="n">phase_6</span><span class="o">+</span><span class="mi">143</span><span class="o">&gt;</span>
   <span class="mh">0x000000000040119f</span> <span class="o">&lt;+</span><span class="mi">171</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x1</span>
   <span class="mh">0x00000000004011a4</span> <span class="o">&lt;+</span><span class="mi">176</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="mh">0x6032d0</span>
   <span class="mh">0x00000000004011a9</span> <span class="o">&lt;+</span><span class="mi">181</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x401176</span> <span class="o">&lt;</span><span class="n">phase_6</span><span class="o">+</span><span class="mi">130</span><span class="o">&gt;</span>
   <span class="mh">0x00000000004011ab</span> <span class="o">&lt;+</span><span class="mi">183</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rbx</span><span class="p">,</span><span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0x20</span><span class="p">]</span>
   <span class="mh">0x00000000004011b0</span> <span class="o">&lt;+</span><span class="mi">188</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rax</span><span class="p">,[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0x28</span><span class="p">]</span>
   <span class="mh">0x00000000004011b5</span> <span class="o">&lt;+</span><span class="mi">193</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rsi</span><span class="p">,[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0x50</span><span class="p">]</span>
   <span class="mh">0x00000000004011ba</span> <span class="o">&lt;+</span><span class="mi">198</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rcx</span><span class="p">,</span><span class="n">rbx</span>
   <span class="mh">0x00000000004011bd</span> <span class="o">&lt;+</span><span class="mi">201</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rdx</span><span class="p">,</span><span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rax</span><span class="p">]</span>
   <span class="mh">0x00000000004011c0</span> <span class="o">&lt;+</span><span class="mi">204</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rcx</span><span class="o">+</span><span class="mh">0x8</span><span class="p">],</span><span class="n">rdx</span>
   <span class="mh">0x00000000004011c4</span> <span class="o">&lt;+</span><span class="mi">208</span><span class="o">&gt;:</span>	<span class="n">add</span>    <span class="n">rax</span><span class="p">,</span><span class="mh">0x8</span>
   <span class="mh">0x00000000004011c8</span> <span class="o">&lt;+</span><span class="mi">212</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">rax</span><span class="p">,</span><span class="n">rsi</span>
   <span class="mh">0x00000000004011cb</span> <span class="o">&lt;+</span><span class="mi">215</span><span class="o">&gt;:</span>	<span class="n">je</span>     <span class="mh">0x4011d2</span> <span class="o">&lt;</span><span class="n">phase_6</span><span class="o">+</span><span class="mi">222</span><span class="o">&gt;</span>
   <span class="mh">0x00000000004011cd</span> <span class="o">&lt;+</span><span class="mi">217</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rcx</span><span class="p">,</span><span class="n">rdx</span>
   <span class="mh">0x00000000004011d0</span> <span class="o">&lt;+</span><span class="mi">220</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x4011bd</span> <span class="o">&lt;</span><span class="n">phase_6</span><span class="o">+</span><span class="mi">201</span><span class="o">&gt;</span>
   <span class="mh">0x00000000004011d2</span> <span class="o">&lt;+</span><span class="mi">222</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rdx</span><span class="o">+</span><span class="mh">0x8</span><span class="p">],</span><span class="mh">0x0</span>
   <span class="mh">0x00000000004011da</span> <span class="o">&lt;+</span><span class="mi">230</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">ebp</span><span class="p">,</span><span class="mh">0x5</span>
   <span class="mh">0x00000000004011df</span> <span class="o">&lt;+</span><span class="mi">235</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rax</span><span class="p">,</span><span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbx</span><span class="o">+</span><span class="mh">0x8</span><span class="p">]</span>
   <span class="mh">0x00000000004011e3</span> <span class="o">&lt;+</span><span class="mi">239</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rax</span><span class="p">]</span>
   <span class="mh">0x00000000004011e5</span> <span class="o">&lt;+</span><span class="mi">241</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbx</span><span class="p">],</span><span class="n">eax</span>
   <span class="mh">0x00000000004011e7</span> <span class="o">&lt;+</span><span class="mi">243</span><span class="o">&gt;:</span>	<span class="n">jge</span>    <span class="mh">0x4011ee</span> <span class="o">&lt;</span><span class="n">phase_6</span><span class="o">+</span><span class="mi">250</span><span class="o">&gt;</span>
   <span class="mh">0x00000000004011e9</span> <span class="o">&lt;+</span><span class="mi">245</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x40143a</span> <span class="o">&lt;</span><span class="n">explode_bomb</span><span class="o">&gt;</span>
   <span class="mh">0x00000000004011ee</span> <span class="o">&lt;+</span><span class="mi">250</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rbx</span><span class="p">,</span><span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbx</span><span class="o">+</span><span class="mh">0x8</span><span class="p">]</span>
   <span class="mh">0x00000000004011f2</span> <span class="o">&lt;+</span><span class="mi">254</span><span class="o">&gt;:</span>	<span class="n">sub</span>    <span class="n">ebp</span><span class="p">,</span><span class="mh">0x1</span>
   <span class="mh">0x00000000004011f5</span> <span class="o">&lt;+</span><span class="mi">257</span><span class="o">&gt;:</span>	<span class="n">jne</span>    <span class="mh">0x4011df</span> <span class="o">&lt;</span><span class="n">phase_6</span><span class="o">+</span><span class="mi">235</span><span class="o">&gt;</span>
   <span class="mh">0x00000000004011f7</span> <span class="o">&lt;+</span><span class="mi">259</span><span class="o">&gt;:</span>	<span class="n">add</span>    <span class="n">rsp</span><span class="p">,</span><span class="mh">0x50</span>
   <span class="mh">0x00000000004011fb</span> <span class="o">&lt;+</span><span class="mi">263</span><span class="o">&gt;:</span>	<span class="n">pop</span>    <span class="n">rbx</span>
   <span class="mh">0x00000000004011fc</span> <span class="o">&lt;+</span><span class="mi">264</span><span class="o">&gt;:</span>	<span class="n">pop</span>    <span class="n">rbp</span>
   <span class="mh">0x00000000004011fd</span> <span class="o">&lt;+</span><span class="mi">265</span><span class="o">&gt;:</span>	<span class="n">pop</span>    <span class="n">r12</span>
   <span class="mh">0x00000000004011ff</span> <span class="o">&lt;+</span><span class="mi">267</span><span class="o">&gt;:</span>	<span class="n">pop</span>    <span class="n">r13</span>
   <span class="mh">0x0000000000401201</span> <span class="o">&lt;+</span><span class="mi">269</span><span class="o">&gt;:</span>	<span class="n">pop</span>    <span class="n">r14</span>
   <span class="mh">0x0000000000401203</span> <span class="o">&lt;+</span><span class="mi">271</span><span class="o">&gt;:</span>	<span class="n">ret</span>    
<span class="n">End</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">dump</span><span class="p">.</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>It looks like it is using the same <code class="language-plaintext highlighter-rouge">read_six_numbers</code> function from Phase 2, and the six numbers are at the bottom of the stack again. One small difference is that before <code class="language-plaintext highlighter-rouge">read_six_numbers</code> is called, <code class="language-plaintext highlighter-rouge">r13</code> is set to <code class="language-plaintext highlighter-rouge">rsp</code> in line 9. Since <code class="language-plaintext highlighter-rouge">r13</code> is a callee saved register, we need to initialize it to <code class="language-plaintext highlighter-rouge">rsp</code>.</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td> <td class="code"><pre><span class="k">def</span> <span class="nf">phase_6</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="n">path_to_binary</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">angr</span><span class="p">.</span><span class="nc">Project</span><span class="p">(</span><span class="n">path_to_binary</span><span class="p">)</span>

    <span class="c1"># Tell Angr where to start executing 
</span>    <span class="n">start_addr</span> <span class="o">=</span> <span class="mh">0x0040110b</span>
    <span class="n">initial_state</span> <span class="o">=</span> <span class="n">project</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="nf">blank_state</span><span class="p">(</span><span class="n">addr</span><span class="o">=</span><span class="n">start_addr</span><span class="p">)</span>


    <span class="n">num_12</span> <span class="o">=</span> <span class="n">claripy</span><span class="p">.</span><span class="nc">BVS</span><span class="p">(</span><span class="sh">'</span><span class="s">num_12</span><span class="sh">'</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
    <span class="n">num_34</span> <span class="o">=</span> <span class="n">claripy</span><span class="p">.</span><span class="nc">BVS</span><span class="p">(</span><span class="sh">'</span><span class="s">num_34</span><span class="sh">'</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
    <span class="n">num_56</span> <span class="o">=</span> <span class="n">claripy</span><span class="p">.</span><span class="nc">BVS</span><span class="p">(</span><span class="sh">'</span><span class="s">num_56</span><span class="sh">'</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>

    <span class="n">initial_state</span><span class="p">.</span><span class="nf">stack_push</span><span class="p">(</span><span class="n">num_56</span><span class="p">)</span>
    <span class="n">initial_state</span><span class="p">.</span><span class="nf">stack_push</span><span class="p">(</span><span class="n">num_34</span><span class="p">)</span>
    <span class="n">initial_state</span><span class="p">.</span><span class="nf">stack_push</span><span class="p">(</span><span class="n">num_12</span><span class="p">)</span>

    <span class="c1"># Setup initial registers
</span>    <span class="n">initial_state</span><span class="p">.</span><span class="n">regs</span><span class="p">.</span><span class="n">r13</span> <span class="o">=</span> <span class="n">initial_state</span><span class="p">.</span><span class="n">regs</span><span class="p">.</span><span class="n">rsp</span>
    <span class="n">initial_state</span><span class="p">.</span><span class="n">regs</span><span class="p">.</span><span class="n">rsi</span> <span class="o">=</span> <span class="n">initial_state</span><span class="p">.</span><span class="n">regs</span><span class="p">.</span><span class="n">rsp</span>

    <span class="c1"># Create a simulation manager initialized with the starting state
</span>    <span class="n">simulation</span> <span class="o">=</span> <span class="n">project</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="nf">simgr</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>With this done, that means we can just re-use the rest of the code for Phase 2 and it will just work, right? Rightttttt?</p> <p>Well, no, unfortunately not. I tried it and the script ran for 1 minute… 2 minutes… 5 minutes… 10 minutes…, and I did not have a good feeling about this as my laptop was becoming something of a portable heater at this point. From the disassembly you can see that there are a lot of jumps and comparisons, way more than in previous phases, and this is leading to state explosion. We need to find a better way.</p> <h3 id="mitigating-state-explosion-by-splitting-up-analysis">Mitigating State Explosion by Splitting Up Analysis</h3> <p>We mitigate the exponential growth in states by decreasing the depth of the search tree of the simulation manager. This can be done by splitting up the function into multiple distinct parts, and then searching through each of them in order. This way, we will search through multiple trees of smaller depths, which could make the problem tractable. Of course, the assumption here is that the function can indeed be split into distinct parts. Let’s try to verify this assumption by seeing how the code jumps around. I decided to do this with Radare, which allows us to see this in a more graphical manner. We could manually eyeball it with GDB’s output as well, but that is just too painful.</p> <p>Let’s open up Radare, and seek to our <code class="language-plaintext highlighter-rouge">phase_6</code> function with <code class="language-plaintext highlighter-rouge">s</code>:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
</pre></td> <td class="code"><pre><span class="err">$</span> <span class="n">r2</span> <span class="n">bomb</span>
<span class="p">[</span><span class="mh">0x00400c90</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">s</span> <span class="n">sym</span><span class="p">.</span><span class="n">phase_6</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>Now output the disassembly with <code class="language-plaintext highlighter-rouge">pdf</code>, which stands for Print Disassemble Function:</p> <p><img src="/assets/images/screenshots/phase_6_r2.webp" alt="Disassembly graph of phase_6"></p> <p>You can see the lines on the left going up and down. Those represents the jumps that can be taken. We also see that there are some obvious blocks in the structure. My original intuition was that the address at 0x00401158 seemed like a pretty good place to split the blocks, since it just finished a bunch of complicated logic in the first half and it looked like a natural transition point. Let’s see how this looks like in code:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td> <td class="code"><pre>    <span class="n">block_1_end</span> <span class="o">=</span> <span class="mh">0x00401158</span> <span class="c1"># after the first distinct block. Note that this will change later
</span>    <span class="n">block_2_end</span> <span class="o">=</span> <span class="mh">0x00401203</span> <span class="c1"># right before ret
</span>
    <span class="n">explode_addr</span> <span class="o">=</span> <span class="mh">0x0040143a</span> <span class="c1"># explode_bomb
</span>
    <span class="c1"># Find all possible ways to reach find condition
</span>    <span class="k">while</span> <span class="nf">len</span><span class="p">(</span><span class="n">simulation</span><span class="p">.</span><span class="n">active</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">simulation</span><span class="p">.</span><span class="nf">explore</span><span class="p">(</span><span class="n">find</span><span class="o">=</span><span class="n">block_1_end</span><span class="p">,</span> <span class="n">avoid</span><span class="o">=</span><span class="n">explode_addr</span><span class="p">)</span>

    <span class="c1"># Find out how many states we have now
</span>    <span class="k">if</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span><span class="p">:</span>
        <span class="n">block_1_states</span> <span class="o">=</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">States found after block 1: </span><span class="sh">"</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">block_1_states</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nc">Exception</span><span class="p">(</span><span class="sh">'</span><span class="s">Could not find the solution</span><span class="sh">'</span><span class="p">)</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>I called the two blocks that we divide the function into as <code class="language-plaintext highlighter-rouge">block 1</code> and <code class="language-plaintext highlighter-rouge">block 2</code>. <code class="language-plaintext highlighter-rouge">block_1_end</code> is where we split the two blocks apart. <code class="language-plaintext highlighter-rouge">block_2_end</code> is simply the end of the function.</p> <p>An important point to highlight is that instead of just performing <code class="language-plaintext highlighter-rouge">simulation.explore</code> and <code class="language-plaintext highlighter-rouge">simulation.found</code> like previously, now we need to find all the states that can reach <code class="language-plaintext highlighter-rouge">block_1_end</code>. If we just did <code class="language-plaintext highlighter-rouge">simulation.found</code> instead, it would stop at the first valid solution that it found, which may not include the states that are actually necessary for us to get to the final solution. Therefore, we keep exploring while <code class="language-plaintext highlighter-rouge">simulation.active</code> is true, which means that there are still available states to explore.</p> <p>This means that <code class="language-plaintext highlighter-rouge">block_1_states</code> will hold all the possible states that can reach <code class="language-plaintext highlighter-rouge">block_1_end</code>, and we can then use each of them as a launching point to reach the end of the function:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td> <td class="code"><pre>    <span class="k">for</span> <span class="n">state</span> <span class="n">in</span> <span class="n">block_1_states</span><span class="o">:</span>
        <span class="n">simulation</span> <span class="o">=</span> <span class="n">project</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="n">simgr</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">simulation</span><span class="p">.</span><span class="n">explore</span><span class="p">(</span><span class="n">find</span><span class="o">=</span><span class="n">block_2_end</span><span class="p">,</span> <span class="n">avoid</span><span class="o">=</span><span class="n">explode_addr</span><span class="p">)</span>

        <span class="cp"># Check whether we found a solution
</span>        <span class="k">if</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span><span class="o">:</span>
            <span class="n">solution_state</span> <span class="o">=</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">num_12_sol</span> <span class="o">=</span> <span class="n">solution_state</span><span class="p">.</span><span class="n">se</span><span class="p">.</span><span class="n">eval</span><span class="p">(</span><span class="n">num_12</span><span class="p">,</span> <span class="n">cast_to</span><span class="o">=</span><span class="kt">int</span><span class="p">)</span>
            <span class="n">num_34_sol</span> <span class="o">=</span> <span class="n">solution_state</span><span class="p">.</span><span class="n">se</span><span class="p">.</span><span class="n">eval</span><span class="p">(</span><span class="n">num_34</span><span class="p">,</span> <span class="n">cast_to</span><span class="o">=</span><span class="kt">int</span><span class="p">)</span>
            <span class="n">num_56_sol</span> <span class="o">=</span> <span class="n">solution_state</span><span class="p">.</span><span class="n">se</span><span class="p">.</span><span class="n">eval</span><span class="p">(</span><span class="n">num_56</span><span class="p">,</span> <span class="n">cast_to</span><span class="o">=</span><span class="kt">int</span><span class="p">)</span>

            <span class="n">def</span> <span class="n">unpack_ints</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">:</span>
                <span class="n">lower_32_mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="n">lower_32_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">lower_32_mask</span><span class="p">)</span>

            <span class="n">num_1_sol</span><span class="p">,</span> <span class="n">num_2_sol</span> <span class="o">=</span> <span class="n">unpack_ints</span><span class="p">(</span><span class="n">num_12_sol</span><span class="p">)</span>
            <span class="n">num_3_sol</span><span class="p">,</span> <span class="n">num_4_sol</span> <span class="o">=</span> <span class="n">unpack_ints</span><span class="p">(</span><span class="n">num_34_sol</span><span class="p">)</span>
            <span class="n">num_5_sol</span><span class="p">,</span> <span class="n">num_6_sol</span> <span class="o">=</span> <span class="n">unpack_ints</span><span class="p">(</span><span class="n">num_56_sol</span><span class="p">)</span>

            <span class="n">print</span><span class="p">(</span><span class="n">f</span><span class="s">"{num_1_sol} {num_2_sol} {num_3_sol} {num_4_sol} {num_5_sol} {num_6_sol}"</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="n">raise</span> <span class="n">Exception</span><span class="p">(</span><span class="err">'</span><span class="n">Could</span> <span class="n">not</span> <span class="n">find</span> <span class="n">the</span> <span class="n">solution</span><span class="err">'</span><span class="p">)</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>In the above, we begin afresh from each of the states that we found in block 1, and then try to see if it leads to a solution. This time round we only need to grab the first valid solution, like usual.</p> <p>I tried running the script:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
</pre></td> <td class="code"><pre><span class="err">$</span> <span class="n">python</span> <span class="n">solve</span><span class="p">.</span><span class="n">py</span> <span class="n">bomb</span>
<span class="n">States</span> <span class="n">found</span> <span class="n">after</span> <span class="n">block</span> <span class="mi">1</span><span class="o">:</span>  <span class="mi">1</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>What?! There is only 1 state found after block 1? That seems like we did not reduce the depth of the search tree by much, since we did not reduce the number of times it branched. Indeed, I kept waiting and waiting and…there was no additional output.</p> <p>For this to work, we need more states to be found after block 1, the more the merrier (but not so much that now you have state explosion in block 1).</p> <p>The next address I tried to set <code class="language-plaintext highlighter-rouge">block_1_end</code> to was <code class="language-plaintext highlighter-rouge">0x00401181</code>, which is right after another distinct mini logic block:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td> <td class="code"><pre><span class="err">$</span> <span class="n">python</span> <span class="n">solve</span><span class="p">.</span><span class="n">py</span> <span class="n">bomb</span>
<span class="n">States</span> <span class="n">found</span><span class="o">:</span>  <span class="mi">10</span>
<span class="n">Block</span> <span class="mi">1</span> <span class="n">cleared</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">23</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">320</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="n">The</span> <span class="n">program</span> <span class="n">is</span> <span class="n">accessing</span> <span class="n">memory</span> <span class="n">or</span> <span class="n">registers</span> <span class="n">with</span> <span class="n">an</span> <span class="n">unspecified</span> <span class="n">value</span><span class="p">.</span> <span class="n">This</span> <span class="n">could</span> <span class="n">indicate</span> <span class="n">unwanted</span> <span class="n">behavior</span><span class="p">.</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">23</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">320</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="n">angr</span> <span class="n">will</span> <span class="n">cope</span> <span class="n">with</span> <span class="n">this</span> <span class="n">by</span> <span class="n">generating</span> <span class="n">an</span> <span class="n">unconstrained</span> <span class="n">symbolic</span> <span class="n">variable</span> <span class="n">and</span> <span class="n">continuing</span><span class="p">.</span> <span class="n">You</span> <span class="n">can</span> <span class="n">resolve</span> <span class="n">this</span> <span class="n">by</span><span class="o">:</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">23</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">320</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="mi">1</span><span class="p">)</span> <span class="n">setting</span> <span class="n">a</span> <span class="n">value</span> <span class="n">to</span> <span class="n">the</span> <span class="n">initial</span> <span class="n">state</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">23</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">320</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="mi">2</span><span class="p">)</span> <span class="n">adding</span> <span class="n">the</span> <span class="n">state</span> <span class="n">option</span> <span class="n">ZERO_FILL_UNCONSTRAINED_</span><span class="p">{</span><span class="n">MEMORY</span><span class="p">,</span><span class="n">REGISTERS</span><span class="p">},</span> <span class="n">to</span> <span class="n">make</span> <span class="n">unknown</span> <span class="n">regions</span> <span class="n">hold</span> <span class="n">null</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">23</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">320</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="mi">3</span><span class="p">)</span> <span class="n">adding</span> <span class="n">the</span> <span class="n">state</span> <span class="n">option</span> <span class="n">SYMBOL_FILL_UNCONSTRAINED_</span><span class="p">{</span><span class="n">MEMORY_REGISTERS</span><span class="p">},</span> <span class="n">to</span> <span class="n">suppress</span> <span class="n">these</span> <span class="n">messages</span><span class="p">.</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">23</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">320</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="n">Filling</span> <span class="n">memory</span> <span class="n">at</span> <span class="mh">0x7ffffffffff0030</span> <span class="n">with</span> <span class="mi">8</span> <span class="n">unconstrained</span> <span class="n">bytes</span> <span class="n">referenced</span> <span class="n">from</span> <span class="mh">0x4011fb</span> <span class="p">(</span><span class="n">phase_6</span><span class="o">+</span><span class="mh">0x107</span> <span class="n">in</span> <span class="n">bomb</span> <span class="p">(</span><span class="mh">0x4011fb</span><span class="p">))</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">23</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">322</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="n">Filling</span> <span class="n">memory</span> <span class="n">at</span> <span class="mh">0x7ffffffffff0038</span> <span class="n">with</span> <span class="mi">8</span> <span class="n">unconstrained</span> <span class="n">bytes</span> <span class="n">referenced</span> <span class="n">from</span> <span class="mh">0x4011fc</span> <span class="p">(</span><span class="n">phase_6</span><span class="o">+</span><span class="mh">0x108</span> <span class="n">in</span> <span class="n">bomb</span> <span class="p">(</span><span class="mh">0x4011fc</span><span class="p">))</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">23</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">323</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="n">Filling</span> <span class="n">memory</span> <span class="n">at</span> <span class="mh">0x7ffffffffff0040</span> <span class="n">with</span> <span class="mi">8</span> <span class="n">unconstrained</span> <span class="n">bytes</span> <span class="n">referenced</span> <span class="n">from</span> <span class="mh">0x4011fd</span> <span class="p">(</span><span class="n">phase_6</span><span class="o">+</span><span class="mh">0x109</span> <span class="n">in</span> <span class="n">bomb</span> <span class="p">(</span><span class="mh">0x4011fd</span><span class="p">))</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">23</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">324</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="n">Filling</span> <span class="n">memory</span> <span class="n">at</span> <span class="mh">0x7ffffffffff0048</span> <span class="n">with</span> <span class="mi">8</span> <span class="n">unconstrained</span> <span class="n">bytes</span> <span class="n">referenced</span> <span class="n">from</span> <span class="mh">0x4011ff</span> <span class="p">(</span><span class="n">phase_6</span><span class="o">+</span><span class="mh">0x10b</span> <span class="n">in</span> <span class="n">bomb</span> <span class="p">(</span><span class="mh">0x4011ff</span><span class="p">))</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">23</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">326</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="n">Filling</span> <span class="n">memory</span> <span class="n">at</span> <span class="mh">0x7ffffffffff0050</span> <span class="n">with</span> <span class="mi">8</span> <span class="n">unconstrained</span> <span class="n">bytes</span> <span class="n">referenced</span> <span class="n">from</span> <span class="mh">0x401201</span> <span class="p">(</span><span class="n">phase_6</span><span class="o">+</span><span class="mh">0x10d</span> <span class="n">in</span> <span class="n">bomb</span> <span class="p">(</span><span class="mh">0x401201</span><span class="p">))</span>
<span class="n">CRITICAL</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">23</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">330</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">sim_state</span> <span class="o">|</span> <span class="n">The</span> <span class="n">name</span> <span class="n">state</span><span class="p">.</span><span class="n">se</span> <span class="n">is</span> <span class="n">deprecated</span><span class="p">;</span> <span class="n">please</span> <span class="n">use</span> <span class="n">state</span><span class="p">.</span><span class="n">solver</span><span class="p">.</span>
<span class="mi">4</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">6</span> <span class="mi">5</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>We found 10 states after block 1. This is what we like to see! And indeed, after a few minutes of waiting, we get our well-deserved result: <code class="language-plaintext highlighter-rouge">4 3 2 1 6 5</code>.</p> <h3 id="full-solution-script">Full Solution Script</h3> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
</pre></td> <td class="code"><pre><span class="n">import</span> <span class="n">angr</span>
<span class="n">import</span> <span class="n">claripy</span>
<span class="n">import</span> <span class="n">sys</span>

<span class="n">def</span> <span class="n">phase_6</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span><span class="o">:</span>
    <span class="n">path_to_binary</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">angr</span><span class="p">.</span><span class="n">Project</span><span class="p">(</span><span class="n">path_to_binary</span><span class="p">)</span>

    <span class="cp"># Tell Angr where to start executing 
</span>    <span class="n">start_addr</span> <span class="o">=</span> <span class="mh">0x0040110b</span>
    <span class="n">initial_state</span> <span class="o">=</span> <span class="n">project</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="n">blank_state</span><span class="p">(</span><span class="n">addr</span><span class="o">=</span><span class="n">start_addr</span><span class="p">)</span>

    <span class="n">num_12</span> <span class="o">=</span> <span class="n">claripy</span><span class="p">.</span><span class="n">BVS</span><span class="p">(</span><span class="err">'</span><span class="n">num_12</span><span class="err">'</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
    <span class="n">num_34</span> <span class="o">=</span> <span class="n">claripy</span><span class="p">.</span><span class="n">BVS</span><span class="p">(</span><span class="err">'</span><span class="n">num_34</span><span class="err">'</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
    <span class="n">num_56</span> <span class="o">=</span> <span class="n">claripy</span><span class="p">.</span><span class="n">BVS</span><span class="p">(</span><span class="err">'</span><span class="n">num_56</span><span class="err">'</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>

    <span class="n">initial_state</span><span class="p">.</span><span class="n">stack_push</span><span class="p">(</span><span class="n">num_56</span><span class="p">)</span>
    <span class="n">initial_state</span><span class="p">.</span><span class="n">stack_push</span><span class="p">(</span><span class="n">num_34</span><span class="p">)</span>
    <span class="n">initial_state</span><span class="p">.</span><span class="n">stack_push</span><span class="p">(</span><span class="n">num_12</span><span class="p">)</span>

    <span class="cp"># Setup initial registers
</span>    <span class="n">initial_state</span><span class="p">.</span><span class="n">regs</span><span class="p">.</span><span class="n">r13</span> <span class="o">=</span> <span class="n">initial_state</span><span class="p">.</span><span class="n">regs</span><span class="p">.</span><span class="n">rsp</span>
    <span class="n">initial_state</span><span class="p">.</span><span class="n">regs</span><span class="p">.</span><span class="n">rsi</span> <span class="o">=</span> <span class="n">initial_state</span><span class="p">.</span><span class="n">regs</span><span class="p">.</span><span class="n">rsp</span>

    <span class="cp"># Create a simulation manager initialized with the starting state
</span>    <span class="n">simulation</span> <span class="o">=</span> <span class="n">project</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="n">simgr</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>

    <span class="n">block_1_end</span> <span class="o">=</span> <span class="mh">0x00401181</span>
    <span class="n">block_2_end</span> <span class="o">=</span> <span class="mh">0x00401203</span> <span class="err">#</span> <span class="n">right</span> <span class="n">before</span> <span class="n">ret</span>

    <span class="n">explode_addr</span> <span class="o">=</span> <span class="mh">0x0040143a</span> <span class="err">#</span> <span class="n">explode_bomb</span>

    <span class="cp"># Find all possible ways to reach find condition
</span>    <span class="k">while</span> <span class="n">len</span><span class="p">(</span><span class="n">simulation</span><span class="p">.</span><span class="n">active</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">:</span>
        <span class="n">simulation</span><span class="p">.</span><span class="n">explore</span><span class="p">(</span><span class="n">find</span><span class="o">=</span><span class="n">block_1_end</span><span class="p">,</span> <span class="n">avoid</span><span class="o">=</span><span class="n">explode_addr</span><span class="p">)</span>

    <span class="cp"># Find out how many states we have now
</span>    <span class="k">if</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span><span class="o">:</span>
        <span class="n">block_1_states</span> <span class="o">=</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span>
        <span class="n">print</span><span class="p">(</span><span class="s">"States found after block 1: "</span><span class="p">,</span> <span class="n">len</span><span class="p">(</span><span class="n">block_1_states</span><span class="p">))</span>
    <span class="k">else</span><span class="o">:</span>
        <span class="n">raise</span> <span class="n">Exception</span><span class="p">(</span><span class="err">'</span><span class="n">Could</span> <span class="n">not</span> <span class="n">find</span> <span class="n">the</span> <span class="n">solution</span><span class="err">'</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">state</span> <span class="n">in</span> <span class="n">block_1_states</span><span class="o">:</span>
        <span class="n">simulation</span> <span class="o">=</span> <span class="n">project</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="n">simgr</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">simulation</span><span class="p">.</span><span class="n">explore</span><span class="p">(</span><span class="n">find</span><span class="o">=</span><span class="n">block_2_end</span><span class="p">,</span> <span class="n">avoid</span><span class="o">=</span><span class="n">explode_addr</span><span class="p">)</span>

        <span class="cp"># Check whether we found a solution
</span>        <span class="k">if</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span><span class="o">:</span>
            <span class="n">solution_state</span> <span class="o">=</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">num_12_sol</span> <span class="o">=</span> <span class="n">solution_state</span><span class="p">.</span><span class="n">se</span><span class="p">.</span><span class="n">eval</span><span class="p">(</span><span class="n">num_12</span><span class="p">,</span> <span class="n">cast_to</span><span class="o">=</span><span class="kt">int</span><span class="p">)</span>
            <span class="n">num_34_sol</span> <span class="o">=</span> <span class="n">solution_state</span><span class="p">.</span><span class="n">se</span><span class="p">.</span><span class="n">eval</span><span class="p">(</span><span class="n">num_34</span><span class="p">,</span> <span class="n">cast_to</span><span class="o">=</span><span class="kt">int</span><span class="p">)</span>
            <span class="n">num_56_sol</span> <span class="o">=</span> <span class="n">solution_state</span><span class="p">.</span><span class="n">se</span><span class="p">.</span><span class="n">eval</span><span class="p">(</span><span class="n">num_56</span><span class="p">,</span> <span class="n">cast_to</span><span class="o">=</span><span class="kt">int</span><span class="p">)</span>

            <span class="n">def</span> <span class="n">unpack_ints</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">:</span>
                <span class="n">lower_32_mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="n">lower_32_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">lower_32_mask</span><span class="p">)</span>

            <span class="n">num_1_sol</span><span class="p">,</span> <span class="n">num_2_sol</span> <span class="o">=</span> <span class="n">unpack_ints</span><span class="p">(</span><span class="n">num_12_sol</span><span class="p">)</span>
            <span class="n">num_3_sol</span><span class="p">,</span> <span class="n">num_4_sol</span> <span class="o">=</span> <span class="n">unpack_ints</span><span class="p">(</span><span class="n">num_34_sol</span><span class="p">)</span>
            <span class="n">num_5_sol</span><span class="p">,</span> <span class="n">num_6_sol</span> <span class="o">=</span> <span class="n">unpack_ints</span><span class="p">(</span><span class="n">num_56_sol</span><span class="p">)</span>

            <span class="n">print</span><span class="p">(</span><span class="n">f</span><span class="s">"{num_1_sol} {num_2_sol} {num_3_sol} {num_4_sol} {num_5_sol} {num_6_sol}"</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="n">raise</span> <span class="n">Exception</span><span class="p">(</span><span class="err">'</span><span class="n">Could</span> <span class="n">not</span> <span class="n">find</span> <span class="n">the</span> <span class="n">solution</span><span class="err">'</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="err">'</span><span class="n">__main__</span><span class="err">'</span><span class="o">:</span>
    <span class="n">phase_6</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>Let’s try it on the actual binary:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td> <td class="code"><pre><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">bomb</span>
<span class="n">Welcome</span> <span class="n">to</span> <span class="n">my</span> <span class="n">fiendish</span> <span class="n">little</span> <span class="n">bomb</span><span class="p">.</span> <span class="n">You</span> <span class="n">have</span> <span class="mi">6</span> <span class="n">phases</span> <span class="n">with</span>
<span class="n">which</span> <span class="n">to</span> <span class="n">blow</span> <span class="n">yourself</span> <span class="n">up</span><span class="p">.</span> <span class="n">Have</span> <span class="n">a</span> <span class="n">nice</span> <span class="n">day</span><span class="o">!</span>
<span class="n">Border</span> <span class="n">relations</span> <span class="n">with</span> <span class="n">Canada</span> <span class="n">have</span> <span class="n">never</span> <span class="n">been</span> <span class="n">better</span><span class="p">.</span>
<span class="n">Phase</span> <span class="mi">1</span> <span class="n">defused</span><span class="p">.</span> <span class="n">How</span> <span class="n">about</span> <span class="n">the</span> <span class="n">next</span> <span class="n">one</span><span class="o">?</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">8</span> <span class="mi">16</span> <span class="mi">32</span>
<span class="n">That</span><span class="err">'</span><span class="n">s</span> <span class="n">number</span> <span class="mi">2</span><span class="p">.</span>  <span class="n">Keep</span> <span class="n">going</span><span class="o">!</span>
<span class="mi">1</span> <span class="mi">311</span>
<span class="n">Halfway</span> <span class="n">there</span><span class="o">!</span>
<span class="mi">7</span> <span class="mi">0</span>
<span class="n">So</span> <span class="n">you</span> <span class="n">got</span> <span class="n">that</span> <span class="n">one</span><span class="p">.</span>  <span class="n">Try</span> <span class="n">this</span> <span class="n">one</span><span class="p">.</span>
<span class="mi">9</span><span class="o">?&gt;</span><span class="mi">567</span>
<span class="n">Good</span> <span class="n">work</span><span class="o">!</span>  <span class="n">On</span> <span class="n">to</span> <span class="n">the</span> <span class="n">next</span><span class="p">...</span>
<span class="mi">4</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">6</span> <span class="mi">5</span>
<span class="n">Congratulations</span><span class="o">!</span> <span class="n">You</span><span class="err">'</span><span class="n">ve</span> <span class="n">defused</span> <span class="n">the</span> <span class="n">bomb</span><span class="o">!</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>It worked! We’ve come a long way and you should be proud of yourselves. If any of you actually solved this before (wink wink 15-213 students), you would remember how long this phase took, where you would slowly realise that you were dealing with a linked list and then you probably had to graph out the pointers in the linked list to figure out what their relationships were, but Angr solved it without us having to be aware of what is happening at all!</p> <p>Thanks for reading thus far, and I hope to see you again for the last and final phase - the Secret Phase, which you can find <a href="/blog/2020/breaking-cmu-bomblab-with-angr-for-fun-and-profit-part-7/">here</a>.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <p class="mb-2">Related Posts:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/llama-3.1-technical-report-notes/">Notes on 'The Llama 3 Herd of Models'</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/setting-up-yuancon-controller-sound-voltex/">Playing Sound Voltex at Home: Setting Up Unnamed SDVX Clone with the Yuancon SDVX Controller</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/creating-trackback-requests/">Creating Trackback Requests for Static Sites</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/high-dimensional-analysis-of-m-estimators/">A Unified Framework for High-Dimensional Analysis of M-Estimators with Decomposable Regularizers: A Guided Walkthrough</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/cmu-steam-tunnels/">The CMU Steam Tunnels and Wean 9</a> </li> <div id="giscus_thread" style="max-width: 930px; margin: 0 auto;"> <script>
      let giscusTheme = determineComputedTheme();
      let giscusAttributes = {
        src: 'https://giscus.app/client.js',
        'data-repo': 'fanpu/fanpu.github.io',
        'data-repo-id': '',
        'data-category': 'Comments',
        'data-category-id': '',
        'data-mapping': 'title',
        'data-strict': '1',
        'data-reactions-enabled': '1',
        'data-emit-metadata': '0',
        'data-input-position': 'bottom',
        'data-theme': giscusTheme,
        'data-lang': 'en',
        crossorigin: 'anonymous',
        async: '',
      };

      let giscusScript = document.createElement('script');
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById('giscus_thread').appendChild(giscusScript);
    </script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Fan Pu Zeng. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Last updated: January 01, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script src="/assets/js/tooltips-setup.js?53023e960fbc64cccb90d32e9363de2b"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-S3VHEYH05S"></script> <script defer src="/assets/js/google-analytics-setup.js?12374742c4b1801ba82226e617af7e2d"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>